
# How to create kubeconfig for SA

1. Create sa

	kubectl create sa test -n test

2. Get token:

	kubectl get token test -n test   # this token will expire in 1h

3. Add token to kubeconfig file:

---
apiVersion: v1
kind: Config
clusters:
- name: my-cluster
  cluster:
    server: https://<ip_kube_api>:6443
    certificate-authority-data: LS0tLS1CRUdTyiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCVENDQWUyZ0F3SUJBZ0lJRTdGME9FVDhuUU13RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TlRBek1UQXlNREl3TURsYUZ3MHpOVEF6TURneU1ESTFNRGxhTUJVeApFekFSQmdOVkJBTVRDbXQxWW1WeWJtVjBaWE13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUURERGVpTUxhT3lycmtuL3dDcjVEbHRkeEdheFRtRHFLcDFqUTBBOG1paUdHTHUwNUVvNEM0QWU5eisKWnN2bzVJQXZUZzNVUGF5aDc2N0UwUnFZQ05VbWFrY1NVTWQvUTJ2T3pxTlk3TkhvVmpWaHRnczcrdWh0amxoRAp3TE51UEdld1dvdXFQQ0RqOWJyK2lvbW5WZlVtenBIcGlLTFF0TzdLUDJFWlRZYm9pZ1VZZWQya1hmV2xCeitCCmZYR2pXUDJUQUtGWHhzNUEyei9abGNUZ2NLaVNObExMbHk2MFU0SVZpd2xLZ2xNd1lJLzUvR3Y1UFh4cU1OMDEKODh2SFpYY2lHb0JRU2FMMGxndFhPZUZKNDkvSnJ3MGRZSTllLzJVeDFHVGZHQVkyNnAxQ3dxdm1pQzFMdHErNApKNmsyQ21EcmJFc3NmSnZhUDBtV1ZnL1czQ09iQWdNQkFBR2pXVEJYTUE0R0ExVWREd0VCL3dRRUF3SUNwREFQCkJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJTbVNNTzF3MUluL2VMcjVQN2VPamZJN1g1cllUQVYKQmdOVkhSRUVEakFNZ2dwcmRXSmxjbTVsZEdWek1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQkZBRWVMRnBSWgphMTR4M2JYaTRFRHFFZk5CSVJsOVdod0FBRTlDS0NCemcwakVrdCtOMmVaVXl1QnZza201TjBubE9weXJJVEpzCkpRUXRFUWlpSVFBTmcwQXpaN1RjUmhvYjI2Mkt0K0lvTWxOUlVWeHFCaVUyRFJQQlVybzVqVjdVbktKaUNjOFoKUzhxTURwQU15eW9MWUtoamNxZ2RkRllKQ05GdkpuUHRyY0VZUXlHR3VXOWdxZDJNaFNhQk5BdHNRK09YVlI4KwpaSHQ1VDhqT0xLWUExQUNibVZDR0VRa1hpSzVic25uR1lqdW9uS1IzajU0WUM4QW5RWUNuYjhnNlB2TVNVdjBzCmRqWlp4djMvZ0xlNXNBWWNnQzNKOTZydTB2MlhmVnNuZ3JBaTBOWmZYdGFhNDZFL2UydGRzLzhiN3BDRE1wSXcKUXlGUkh2Y0NzTXk0Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
users:
- name: test
  user:
    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IlMxSk7XbTI2aUxVV2dZV1BJOHZnUk04NVNmRzFxRU1SdjRYd3UwRUxuaFkifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJ0ZXN0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InRva2VuLXRlc3QiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoidGVzdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjBkNDUzMTgzLTlmOTEtNDAzMy05YzBkLWY3ZjlkNDhhYjNmNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDp0ZXN0OnRlc3QifQ.Ins0OHyKtQZgq5_bMKl8MHtbSYAN-ZlePwTfsqLS7adeePFVV7kv7aZu7BD2H1O_8vW5puBobkOLmg9YAf3GXJ1QG0EaFkSAdiwohBhMguclQzESu0qbvMx0WJrsOwKGMwUiyKOU4YFlMMMent2zD_gIMkkBBvP9Bef-o_YZ2o__Pi_oWZX6eDsJJG5tTdPxKmh-ERjvQ5AnxD6Rw6M8XDbrjbdgdjAm9QS2qkGCgmG7XTltETngm_Pz8z1uh0YHdQoGDxXKIXzdRMoT7ysWE_Xzom4bprqHV6tLkTm1NIF5SbRwvA3z8rJzZp7jUXm8kn-7GXdRB6xz-5SXOKZ4_Q
contexts:
- name: my-sa-context
  context:
    cluster: my-cluster
    user: test
    namespace: test
current-context: my-sa-context



---> In case you want never expires token:

1. Create secret for sa:

---
apiVersion: v1
kind: Secret
metadata:
  name: token-test
  namespace: test
  annotations:
    kubernetes.io/service-account.name: test
type: kubernetes.io/service-account-token


2. Get secret and convert token with base64

3. Add token to kubeconfig file:




